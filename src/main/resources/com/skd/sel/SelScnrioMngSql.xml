<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skd.sel.sel_scnrio_mng">
  <select id="getScnrioLst" parameterType="HashMap" resultType="HashMap">
    SELECT ssts.scnrio_num AS scnrio_num
         , ssts.scnrio_nm AS scnrio_nm
         , ssts.scnrio_desc AS scnrio_desc
    FROM (SELECT @ROWNUM := @ROWNUM + 1 AS rownum
               , ssts.scnrio_num AS scnrio_num
               , ssts.scnrio_nm AS scnrio_nm
               , ssts.scnrio_desc AS scnrio_desc
          FROM   skd_sel_test_scnrio ssts
               , (SELECT @ROWNUM := 0) r
          WHERE  NOW() BETWEEN ssts.eff_sta_dtm AND ssts.eff_end_dtm
          AND    (#{sch_txt} = NULL OR ssts.scnrio_nm LIKE CONCAT(CONCAT('%', IFNULL(#{sch_txt}, '')), '%'))
          ORDER BY scnrio_num
         ) ssts
    WHERE #{page_num} IS NULL
    OR    #{page_num} = 0
    OR    (ssts.rownum &lt;= IFNULL(#{page_num}, 1) * 40
           AND ssts.rownum &gt;= (IFNULL(#{page_num}, 1) - 1) * 40 + 1
          )
  </select>
  <select id="getSrcCdByScnrioNum" parameterType="HashMap" resultType="HashMap">
    SELECT ssts.src_cd AS src_cd
    FROM   skd_sel_test_scnrio ssts
    WHERE  ssts.scnrio_num = #{scnrio_num}
    AND    NOW() BETWEEN ssts.eff_sta_dtm AND ssts.eff_end_dtm
  </select>
  <select id="getTestCaseInfoByScnrioNum" parameterType="HashMap" resultType="HashMap">
    SELECT sstc.case_num AS case_num
         , sstc.case_nm AS case_nm
         , sstc.case_desc AS case_desc
    FROM   skd_sel_test_scnrio ssts
         , skd_sel_test_case sstc
    WHERE  ssts.scnrio_num = #{scnrio_num}
    AND    NOW() BETWEEN ssts.eff_sta_dtm AND ssts.eff_end_dtm
    AND    ssts.scnrio_num = sstc.scnrio_num
    AND    NOW() BETWEEN sstc.eff_sta_dtm AND sstc.eff_end_dtm
    ORDER BY sstc.seq_num
  </select>
</mapper>